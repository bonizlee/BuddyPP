<!DOCTYPE html>
<!--html5-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from www.arduino.cc/en/Reference/SPI by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 26 Oct 2015 14:03:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
  	<meta charset="utf-8" />

	<title>Arduino - SPI </title>
	<link rel="shortcut icon" type="image/x-icon" href="../favicon.png" />

	<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>

	<link rel="stylesheet" href="../../fonts/fonts.css" type="text/css" />
	<link rel="stylesheet" href="../../css/arduino-icons.css">
	<link rel="stylesheet" href="../../css/animation.css"><!--[if IE 7]>
	<link rel="stylesheet" href="//arduino.cc/css/arduino-icons-ie7.css"><![endif]-->
	<!--[if gte IE 9]><!-->
	<link rel='stylesheet' href='../../css/foundation2.css' type='text/css' />
	<!--<![endif]-->
	<!--[if IE 8]>
		<link rel='stylesheet' href='//arduino.cc/css/foundation_ie8.css' type='text/css' />
	<![endif]-->
	<link rel='stylesheet' href='../../css/arduino_code_highlight.css' type='text/css' />
	<link rel="stylesheet" type="text/css" media="screen" href="../../css/typeplate.css">
	<link rel='stylesheet' href='../pub/skins/arduinoWide_SSO/css/arduinoWide_SSO.css' type='text/css' />

	<link rel='stylesheet' href='../../css/common.css' type='text/css' />
	<link rel="stylesheet" href="../../css/download_page.css" />
	<link href="https://plus.google.com/114839908922424087554" rel="publisher" />

	<!-- embedded JS and CSS from PmWiki plugins -->	
	<!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
span.anchor {
	float: left;
	font-size: 10px;
	margin-left: -10px;
	width: 10px;
    position:relative; top:-0.1em;
	text-align: center;
}
span.anchor a { text-decoration: none; }
span.anchor a:hover { text-decoration: underline; }
ol.toc { text-indent:-20px; list-style: none; }
ol.toc ol.toc { text-indent:-40px; }
div.tocfloat { font-size: smaller; margin-bottom: 10px;
    border-top: 1px dotted #555555; border-bottom: 1px dotted #555555;
    padding-top: 5px; padding-bottom: 5px; 
    width: 38%; float: right; margin-left: 10px; clear: right;
    margin-right:-13px; padding-right: 13px; padding-left: 13px;
    background-color: #eeeeee; }
div.toc { font-size: smaller; 
    padding: 5px; border: 1px dotted #cccccc;
    background: #f7f7f7;
    margin-bottom: 10px; }
div.toc p { background-color: #f9f6d6;
    margin-top:-5px;   padding-top: 5px;
    margin-left:-5px;  padding-left: 5px;
    margin-right:-5px; padding-right: 5px;
    padding-bottom: 3px;
    border-bottom:  1px dotted #cccccc; }.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border: 2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  td.markup1 { border-bottom: 1px solid #ccf; }
  div.faq { margin-left:2em; }
  div.faq p.question { margin: 1em 0 0.75em -2em; font-weight:bold; }
  div.faq hr { margin-left: -2em; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style><script type="text/javascript">
function toggle(obj) {
    var elstyle = document.getElementById(obj).style;
    var text    = document.getElementById(obj + "tog");
    if (elstyle.display == 'none') {
        elstyle.display = 'block';
        text.innerHTML = "hide";
    } else {
        elstyle.display = 'none';
        text.innerHTML = "show";
    }
}
</script><script src="http://www.arduino.cc/en/pub/galleria/galleria-1.2.6.min.js"></script><script type="text/javascript">Galleria.loadTheme("http://www.arduino.cc/en/pub/galleria/themes/classic/galleria.classic.min.js");</script>  <meta name='robots' content='index,follow' />


	<script src="http://arduino.cc/js/vendor/custom.modernizr.js"></script>

	<!-- do not remove none of those lines, comments embedding in pages will break! -->
	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js" type="text/javascript"></script>
	<script src="http://arduino.cc/en/pub/js/newsletter_subscribe_popup.js" type="text/javascript"></script>
	<script src="https://checkout.stripe.com/checkout.js" type="text/javascript"></script>
	<script src="https://www.arduino.cc/en/pub/js/software_download.js" type="text/javascript"></script><!-- keep https! -->
	<link rel='stylesheet' href='../../../code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.min.css' type='text/css' />
</head>
<body>

	<div id="menuWings" class="fixed"></div>
	<div id="page">
		
		
<script>
	var userAgent = (navigator.userAgent || navigator.vendor || window.opera).toLowerCase();
	if(userAgent.indexOf('mac')>0){
		$("head").append('<style type="text/css">@-moz-document url-prefix() {h1 a, h2 a, h3 a, h4 a, h5 a, h1 a:hover, h2 a:hover, th a, th a:hover, h3 a:hover, h4 a:hover, h5 a:hover, #wikitext h2 a:hover, #wikitext h3 a:hover, #wikitext h4 a:hover {padding-bottom: 0.5em!important;} #pageheader .search input{font-family: "TyponineSans Regular 18";} #pagefooter .monospace{margin-top: -4px;} #navWrapper ul.left &gt; li{margin-top: -2px; padding-bottom: 2px;}#navWrapper ul.right &gt; li{margin-top: -5px; padding-bottom: 5px;}#navWrapper ul.right &gt; li ul{margin-top: 4px;} .slider-container .fixed-caption p{padding:8px 0 14px 0}}</style>');
	}
</script>

<!--[if IE]>
<link rel='stylesheet' href='https://id.arduino.cc//css/ie-monospace.css' type='text/css' />
<![endif]-->

<div id="menuWings" class="fixed"></div>

<!--[if IE 8]>
<div class="alert-box panel ie8alert">
  <p><strong>Arduino.cc offers limited compatibility for Internet Explorer 8. Get a modern browser as Chrome, Firefox or Safari.</strong></p>
  <a href="" class="close">&times;</a>
</div>
<![endif]-->

 

		<div id="pagetext">
				<!--PageText-->
<div id='wikitext'>
<p><strong>Reference</strong> &nbsp;  <a class='wikilink' href='HomePage.html'>Language</a> | <a class='wikilink' href='Libraries.html'>Libraries</a> | <a class='wikilink' href='Comparison.html'>Comparison</a> | <a class='wikilink' href='Changes.html'>Changes</a>
</p>
<p class='vspace'></p><h2>SPI library</h2>
<p class='vspace'></p><table ><tr><td  width='55%' valign='top'>
<p class='vspace'></p><p>This library allows you to communicate with SPI devices, with the Arduino as the master device.  
</p>
<p class='vspace'></p><h3>A Brief Introduction to the Serial Peripheral Interface (SPI)</h3>
<p>Serial Peripheral Interface (SPI) is a synchronous serial data protocol used by microcontrollers for communicating with one or more peripheral devices quickly over short distances. It can also be used for communication between two microcontrollers. 
</p>
<p class='vspace'></p><p>With an SPI connection there is always one master device (usually a microcontroller) which controls the peripheral devices. Typically there are three lines common to all the devices:
</p><ul><li><strong>MISO</strong> (Master In Slave Out) - The Slave line for sending data to the master, 
</li><li><strong>MOSI</strong> (Master Out Slave In) - The Master line for sending data to the peripherals, 
</li><li><strong>SCK</strong> (Serial Clock) - The clock pulses which synchronize data transmission generated by the master 
</li></ul><p class='vspace'></p><p>and one line specific for every device:
</p><ul><li><strong>SS</strong> (Slave Select) - the pin on each device that the master can use to enable and disable specific devices.
</li></ul><p class='vspace'></p><p>When a device's Slave Select pin is low, it communicates with the master.  When it's high, it ignores the master.  This allows you to have multiple SPI devices sharing the same MISO, MOSI, and CLK lines.
</p>
<p class='vspace'></p><p>To write code for a new SPI device you need to note a few things:
</p><ul><li>What is the maximum SPI speed your device can use? This is controlled by the first parameter in <span class='wikiword'>SPISettings</span>.  If you are using a chip rated at 15 <span class='wikiword'>MHz</span>, use 15000000.  Arduino will automatically use the best speed that is equal to or less than the number you use with <span class='wikiword'>SPISettings</span>.
</li><li>Is data shifted in Most Significant Bit (MSB) or Least Significant Bit (LSB) first? This is controlled by second <span class='wikiword'>SPISettings</span> parameter, either MSBFIRST or LSBFIRST. Most SPI chips use MSB first data order.
</li><li>Is the data clock idle when high or low? Are samples on the rising or falling edge of clock pulses? These modes are controlled by the third parameter in <span class='wikiword'>SPISettings</span>.
</li></ul><p class='vspace'></p><p>The SPI standard is loose and each device implements it a little differently. This means you have to pay special attention to the device's datasheet when writing your  code. 
</p>
<p class='vspace'></p><p>Generally speaking, there are four modes of transmission. These modes control whether data is shifted in and out on the rising or falling edge of the data clock signal (called the clock <strong>phase</strong>), and whether the clock is idle when high or low (called the clock <strong>polarity</strong>). The four modes combine polarity and phase according to this table:
</p>
<p class='vspace'></p>
<table  border='1' style="border-collapse:collapse" cellpadding='5' width='90%'><tr ><td  align='center'><strong>Mode</strong></td><td  align='center'><strong>Clock Polarity (CPOL)</strong></td><td  align='center'><strong>Clock Phase (CPHA)</strong></td></tr>
<tr ><td  align='center'>SPI_MODE0</td><td  align='center'>0</td><td  align='center'>0</td></tr>
<tr ><td  align='center'>SPI_MODE1</td><td  align='center'>0</td><td  align='center'>1</td></tr>
<tr ><td  align='center'>SPI_MODE2</td><td  align='center'>1</td><td  align='center'>0</td></tr>
<tr ><td  align='center'>SPI_MODE3</td><td  align='center'>1</td><td  align='center'>1</td></tr>
</table>
<p class='vspace'></p><p>Once you have your SPI parameters, use SPI.beginTransaction() to begin using the SPI port.  The SPI port will be configured with your all of your settings.  The simplest and most efficient way to use <span class='wikiword'>SPISettings</span> is directly inside SPI.beginTransaction().
For example:
</p>
<p class='vspace'></p><p><code>SPI.beginTransaction(<span class='wikiword'>SPISettings</span>(14000000, MSBFIRST, SPI_MODE0));</code>
</p>
<p class='vspace'></p><p>If other libraries use SPI from interrupts, they will be prevented from accessing SPI until you call <code>SPI.endTransaction()</code>.  The SPI settings are applied at the <strong>begin</strong> of the transaction and <code>SPI.endTransaction()</code> <strong>doesn't change</strong> SPI settings. <strong>Unless</strong> you, or some library, <strong>calls</strong> beginTransaction a second time, the setting are <strong>maintained</strong>.  You should attempt to minimize the time between before you call <code>SPI.endTransaction()</code>, for best compatibility if your program is used together with other libraries which use SPI.
</p>
<p class='vspace'></p><p>With most SPI devices, after <code>SPI.beginTransaction()</code>, you will write the slave select pin LOW, call <code>SPI.transfer()</code> any number of times to transfer data, then write the SS pin HIGH, and finally call <code>SPI.endTransaction()</code>.
</p>
<p class='vspace'></p><p>For more on SPI, see <a class='urllink' href='http://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus#Mode_Numbers' rel='nofollow'>Wikipedia's page on SPI</a>.
</p>
<p class='vspace'></p><h3>Connections </h3>
<p>The following table display on which pins the SPI lines are broken out on the different Arduino boards:
</p>
<p class='vspace'></p>
<table border='1' style="border-collapse:collapse" cellpadding='5' width='90%'><tr ><td  align='center'><strong>Arduino Board</strong></td><td  align='center'><strong>MOSI</strong></td><td  align='center'><strong>MISO</strong></td><td  align='center'><strong>SCK</strong></td><td  align='center'><strong>SS (slave)</strong></td><td  align='center'><strong>SS (master)</strong></td></tr>
<tr ><td  align='left'>Uno or Duemilanove</td><td  align='center'>11 or ICSP-4</td><td  align='center'>12 or ICSP-1</td><td  align='center'>13 or ICSP-3</td><td  align='center'>10</td><td  align='center'>-</td></tr>
<tr ><td  align='left'>Mega1280 or Mega2560</td><td  align='center'>51 or ICSP-4</td><td  align='center'>50 or ICSP-1</td><td  align='center'>52 or ICSP-3</td><td  align='center'>53</td><td  align='center'>-</td></tr>
<tr ><td  align='left'>Leonardo</td><td  align='center'>ICSP-4</td><td  align='center'>ICSP-1</td><td  align='center'>ICSP-3</td><td  align='center'>-</td><td  align='center'>-</td></tr>
<tr ><td  align='left'>Due</td><td  align='center'>ICSP-4</td><td  align='center'>ICSP-1</td><td  align='left'>ICSP-3</td><td  align='center'>-</td><td  align='center'>4, 10, 52</td></tr>
</table>
<p class='vspace'></p><p>Note that MISO, MOSI, and SCK are available in a consistent physical location on the ICSP header; this is useful, for example, in designing a shield that works on every board.  
</p>
<p class='vspace'></p><div><img src='../uploads/Reference/ICSPHeader.jpg' alt='' title='' /></div>
<p class='vspace'></p><h4>Note about Slave Select (SS) pin on AVR based boards</h4>
<p>All AVR based boards have an SS pin that is useful when they act as a <strong>slave</strong> controlled by an external master. Since this library supports only master mode, this pin should be set always as OUTPUT otherwise the SPI interface could be put automatically into slave mode by hardware, rendering the library inoperative.
</p>
<p class='vspace'></p><p>It is, however, possible to use any pin as the Slave Select (SS) for the devices. For example, the Arduino Ethernet shield uses pin 4 to control the SPI connection to the on-board SD card, and pin 10 to control the connection to the Ethernet controller. 
</p>
<p class='vspace'></p><h3>Examples</h3>
<p>
<ul class="secondary-list">
              <li><a href="https://www.arduino.cc/en/Tutorial/BarometricPressureSensor">Barometric Pressure Sensor</a>: Read air pressure and temperature from a sensor using the SPI protocol.</li>
              <li><a href="https://www.arduino.cc/en/Tutorial/DigitalPotControl">Digital Pot Control</a>: Control a AD5206 digital potentiometer using the SPI protocol.</li>
            </ul>

</p>
<p class='vspace'></p></td><td  width='35%' valign='top'>
<p class='vspace'></p><h4>Functions</h4>
<ul><li><a class='wikilink' href='SPISettings.html'>SPISettings</a>
</li><li><a class='wikilink' href='SPIBegin.html'>begin</a>()
</li><li><a class='wikilink' href='SPIEnd.html'>end</a>()
</li><li><a class='wikilink' href='SPIbeginTransaction.html'>beginTransaction</a>()
</li><li><a class='wikilink' href='SPIendTransaction.html'>endTransaction</a>()
</li><li><a class='wikilink' href='SPISetBitOrder.html'>setBitOrder</a>()
</li><li><a class='wikilink' href='SPISetClockDivider.html'>setClockDivider</a>()
</li><li><a class='wikilink' href='SPISetDataMode.html'>setDataMode</a>()
</li><li><a class='wikilink' href='SPITransfer.html'>transfer</a>()
</li><li><a class='wikilink' href='SPIusingInterrupt.html'>usingInterrupt</a>()
<p class='vspace'></p></li><li><a class='wikilink' href='DueExtendedSPI.html'>Due Extended SPI usage</a>
</li></ul><p class='vspace'></p><h4>See also</h4>
<ul><li><a class='wikilink' href='ShiftOut.html'>shiftOut()</a>
</li><li><a class='wikilink' href='ShiftIn.html'>shiftIn()</a>
</li></ul><p class='vspace'></p></td></tr></table>
<p><a class='wikilink' href='HomePage.html'>Reference Home</a>
</p>
<p class='vspace'></p><p><em>Corrections, suggestions, and new documentation should be posted to the <a class='urllink' href='http://arduino.cc/forum/index.php/board,23.0.html' rel='nofollow'>Forum</a>.</em>
</p>
<p class='vspace'></p><p>The text of the Arduino reference is licensed under a
<a class='urllink' href='http://creativecommons.org/licenses/by-sa/3.0/' rel='nofollow'>Creative Commons Attribution-ShareAlike 3.0 License</a>.  Code samples in the reference are released into the public domain.
</p>
</div>

				
				<!-- AddThis Button Style BEGIN -->
<style>
  .addthis_toolbox {
    margin: 2em 0 1em;
  }
  .addthis_toolbox img {
    float: left;
    height: 25px;
    margin-right: 10px;
    width: auto;
  }
  .addthis_toolbox .social-container {
    float: left;
    height: 27px; 
    width: auto; 
  }
  .addthis_toolbox .social-container .social-content {
    float: left;
    margin-top: 2px;
    max-width: 0;
    overflow: hidden;
    -moz-transition: max-width .3s ease-out;
    -webkit-transition: max-width .3s ease-out;
    -o-transition: max-width .3s ease-out;
    transition: max-width .3s ease-out;
  }
  .addthis_toolbox .social-container:hover .social-content {
    max-width: 100px;
    -moz-transition: max-width .2s ease-in;
    -webkit-transition: max-width .2s ease-in;
    -o-transition: max-width .2s ease-in;
    transition: max-width .2s ease-in;
  }
  .addthis_toolbox .social-container .social-content a {
    float: left;
    margin-right: 5px;
  }

  .addthis_toolbox h3 {
    font-size: 24px;
    text-align: left;
  }
</style>
<!-- AddThis Button Style END -->
<!-- AddThis Button BEGIN -->
 
	
	<!--[if gte IE 9]><!-->
	<script src="http://arduino.cc/js/foundation.min.js"></script>
	<script src="http://arduino.cc/js/foundation.topbar.custom.js"></script>
	<script>
	  $(document).foundation();
	</script>
	<!--<![endif]-->
	<!--[if IE 8]>
	<script src="//arduino.cc/js/foundation_ie8.min.js"></script>
	<script src="//arduino.cc/js/ie8/jquery.foundation.orbit.js"></script>
	<script src="//arduino.cc/js/ie8/jquery.foundation.alerts.js"></script>
	<script src="//arduino.cc/js/app.js"></script>
	
	<script>
	$(window).load(function(){
	  $("#featured").orbit();
	});
	</script>
	<![endif]-->
	
	<script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-22581631-3']);
	  _gaq.push(['_setDomainName', 'arduino.cc']);
	  _gaq.push(['_trackPageview']);
	
	    (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>

	<script>
	  $(window).load(function(){
	    $('a').each (function () {
	      href = $(this).attr ('href');
	      if (href !== undefined && href.substring (0, 4) == 'http' && href.indexOf ('https://www.arduino.cc/en/Reference/arduino.cc') == -1)
	        $(this).attr ('target', '_blank');
	    });

	    // js for language dropdown
	    $('.language-dropdown .current').on('click', function(e){
          e.stopPropagation();
          $('.language-dropdown ul').toggle();
        });

        $('.language-dropdown .selector').on('click', function(e){
          e.stopPropagation();
          $('.language-dropdown ul').toggle();
        });

        $(document).on('click', function(){
          $('.language-dropdown ul:visible').hide();  
        });

        $('.language-dropdown li a').on('click', function(e){
        	$('.language-dropdown .current').text($(this).text());
        });

        //js for product pages navbar
        var menu = $(".product-page-nav");
	    var menuItems = menu.find("a");
	    var timeoutId = null;
	    var limitTop = 600;

	    var menuOffset = $('.product-page-nav li').first().offset();
	    if(menuOffset) {
	    	limitTop = menuOffset.top;
	    }
	    var limitBottom = $('.addthis_toolbox').offset().top;

	    var activateSection = function($sectionToActivate) {
	      var label=$sectionToActivate.attr('label');

	      $(".product-page-nav").find('li').removeClass('active');
	      $sectionToActivate.addClass('active');
	    };

	    menuItems.click(function(e){

	     e.preventDefault();
	      var href = $(this).attr("href"),
	          offsetTop = href === "#" ? 0 : $(href).offset().top,
	          adjust = 0;
	      if($(this).parent('li').hasClass('active') === false) {

	          adjust = 80;

	          $('html, body').animate({
	                scrollTop: offsetTop - adjust
	            }, 1500, 'easeOutExpo');

	      }
	    });

	    $(window).scroll(function () {

	      var windscroll = $(window).scrollTop();

	      if(windscroll < limitTop) {
	        $('.menu').removeClass('sticky');
	        $('.menu').removeClass('fixed');
	      }  else {
	        $('.menu').addClass('sticky');
	      }

	      var menuEdgeBottomOffset = $('.menu.columns').offset();
	      var menuEdgeBottom = 0;
	      if(menuEdgeBottomOffset) {
	      	menuEdgeBottom = menuEdgeBottomOffset.top + $('.menu.columns').height();
	      }
	      if(menuEdgeBottom > limitBottom) {
	        $('.menu').fadeOut();
	      } else {
	        $('.menu').fadeIn();
	      }
	      menuItems.each(function(i) {
	        var href = $(this).attr("href");
	        if ($(href).offset().top <= windscroll + 150) {
	          if(timeoutId) {
	            clearTimeout(timeoutId);
	          }
	          timeoutId = setTimeout(activateSection, 60, $(".product-page-nav").find('li').eq(i));
	        }
	      });

	    });

	  });
	</script>
</body>

<!-- Mirrored from www.arduino.cc/en/Reference/SPI by HTTrack Website Copier/3.x [XR&CO'2010], Mon, 26 Oct 2015 14:03:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
